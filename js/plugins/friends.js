const FriendsJS={requestAPI:(o,s,l)=>{let i=5;!function a(){return new Promise((t,e)=>{let r=0,n=setTimeout(()=>{0===r&&(r=2,n=null,e("请求超时"),0==i&&l())},5e3);fetch(o).then(function(e){if(2!==r&&(clearTimeout(n),t(e),n=null,r=1),e.ok)return e.json();throw new Error("Network response was not ok.")}).then(function(e){i=0,s(e)}).catch(function(e){0<i?(--i,setTimeout(()=>{a()},5e3)):l()})})}()},layout:a=>{const r=a.el;FriendsJS.requestAPI(a.api,function(e){r.querySelector(".loading-wrap").remove();const t=e.content;var n="";t.forEach((e,t)=>{var r='<div class="user-card">';r+='<a class="card-link" target="_blank" rel="external noopener noreferrer"',r+=' href="'+e.url+'">',r+='<img alt="'+e.title+'" src="'+(e.avatar||a.avatar)+'" onerror="javascript:this.onerror=null;this.src=\''+a.avatar+"';\">",r+='<div class="name"><span>'+e.title+"</span></div>",r+="</a>",n+=r+="</div>"}),r.querySelector(".group-body").innerHTML=n},function(){try{r.querySelector(".loading-wrap svg").remove(),r.querySelector(".loading-wrap p").innerText("加载失败，请稍后重试。")}catch(e){}})},start:()=>{for(var e=document.getElementsByClassName("friendsjs-wrap"),t=0;t<e.length;t++){const a=e[t];var r,n=a.getAttribute("api");null!=n&&((r=new Object).el=a,r.api=n,r.class=a.getAttribute("class"),r.avatar="https://cdn.jsdelivr.net/gh/cdn-x/placeholder@1.0.1/avatar/round/3442075.svg",FriendsJS.layout(r))}}};FriendsJS.start(),document.addEventListener("pjax:complete",function(){FriendsJS.start()});