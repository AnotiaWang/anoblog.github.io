document.addEventListener("DOMContentLoaded",function(){volantis.requestAnimationFrame(()=>{VolantisApp.init(),VolantisApp.subscribe(),volantisFancyBox.loadFancyBox(),highlightKeyWords.startFromURL(),locationHash(),volantis.pjax.push(()=>{VolantisApp.pjaxReload(),sessionStorage.setItem("domTitle",document.title),highlightKeyWords.startFromURL(),volantisFancyBox.pjaxReload()},"app.js"),volantis.pjax.send(()=>{volantis.dom.switcher.removeClass("active"),volantis.dom.header.removeClass("z_search-open"),volantis.dom.wrapper.removeClass("sub"),volantis.EventListener.remove()},"app.js")})});const locationHash=()=>{if(window.location.hash){var t=decodeURI(window.location.hash.split("#")[1]).replace(/\ /g,"-");let e=document.getElementById(t);e&&setTimeout(()=>{window.location.hash.startsWith("#fn")?volantis.scroll.to(e,{addTop:-volantis.dom.header.offsetHeight-5,behavior:"instant"}):volantis.scroll.to(e,{addTop:5,behavior:"instant"})},1e3)}},VolantisApp=(()=>{const s={};let o=80;return s.init=()=>{volantis.dom.header&&(o=volantis.dom.header.clientHeight+16),window.onresize=()=>{document.documentElement.clientWidth<500?volantis.isMobile=1:volantis.isMobile=0,volantis.isMobile!=volantis.isMobileOld&&(s.setGlobalHeaderMenuEvent(),s.setHeader(),s.setHeaderSearch())},volantis.scroll.push(s.scrollEventCallBack,"scrollEventCallBack")},s.event=()=>{volantis.dom.$(document.getElementById("scroll-down")).on("click",function(){s.scrolltoElement(volantis.dom.bodyAnchor)})},s.restData=()=>{o=volantis.dom.header?volantis.dom.header.clientHeight+16:80},s.setIsMobile=()=>{document.documentElement.clientWidth<500?(volantis.isMobile=1,volantis.isMobileOld=1):(volantis.isMobile=0,volantis.isMobileOld=0)},s.scrolltoElement=(e,t=o)=>{volantis.scroll.to(e,{top:e.offsetTop-t})},s.scrollEventCallBack=()=>{var e=volantis.dom.bodyAnchor.offsetTop-o,t=volantis.scroll.getScrollTop();volantis.dom.topBtn&&(t>volantis.dom.bodyAnchor.offsetTop?(volantis.dom.topBtn.addClass("show"),0<volantis.scroll.del?volantis.dom.topBtn.removeClass("hl"):volantis.dom.topBtn.addClass("hl")):volantis.dom.topBtn.removeClass("show").removeClass("hl")),volantis.dom.header&&(-1<t-e?volantis.dom.header.addClass("show"):volantis.dom.header.removeClass("show")),pdata.ispage&&volantis.dom.wrapper&&(0<volantis.scroll.del&&100<t?volantis.dom.wrapper.addClass("sub"):volantis.scroll.del<0&&volantis.dom.wrapper.removeClass("sub")),volantis.isMobile&&(pdata.ispage&&volantis.dom.tocTarget&&volantis.dom.toc&&(volantis.dom.tocTarget.removeClass("active"),volantis.dom.toc.removeClass("active")),volantis.dom.mPhoneList&&volantis.dom.mPhoneList.forEach(function(e){volantis.dom.$(e).hide()}))},s.setScrollAnchor=()=>{volantis.dom.topBtn&&volantis.dom.bodyAnchor&&volantis.dom.topBtn.click(e=>{e.preventDefault(),e.stopPropagation(),s.scrolltoElement(volantis.dom.bodyAnchor),e.stopImmediatePropagation()})},s.setHeader=()=>{pdata.ispage&&(volantis.dom.wrapper.find(".nav-sub .title").html(pdata.postTitle),volantis.dom.comment=volantis.dom.$(document.getElementById("s-comment")),volantis.dom.commentTarget=volantis.dom.$(document.querySelector("#l_main article#comments")),volantis.dom.commentTarget?volantis.dom.comment.click(e=>{e.preventDefault(),e.stopPropagation(),s.scrolltoElement(volantis.dom.commentTarget),e.stopImmediatePropagation()}):volantis.dom.comment.style.display="none",volantis.isMobile&&(volantis.dom.toc=volantis.dom.$(document.getElementById("s-toc")),volantis.dom.tocTarget=volantis.dom.$(document.querySelector("#l_side .toc-wrapper")),volantis.dom.tocTarget?(volantis.dom.toc.click(e=>{e.stopPropagation(),volantis.dom.tocTarget.toggleClass("active"),volantis.dom.toc.toggleClass("active")}),volantis.dom.$(document).click(function(e){e.stopPropagation(),volantis.dom.tocTarget&&volantis.dom.tocTarget.removeClass("active"),volantis.dom.toc.removeClass("active")})):volantis.dom.toc.style.display="none"))},s.setHeaderMenuSelection=()=>{volantis.dom.headerMenu=volantis.dom.$(document.querySelectorAll("#l_header .navigation,#l_cover .navigation,#l_side .navigation")),volantis.dom.headerMenu.forEach(e=>{let t=volantis.dom.$(e).find("li a.active");t&&t.removeClass("active");let o=volantis.dom.$(e).find("div a.active");o&&o.removeClass("active")});var t=location.pathname.replace(/\/|%|\./g,""),e=(t=0==t.length?"home":t).match(/page\d{0,}$/g);e&&(e=e[0],t=t.split(e)[0]);e=t.match(/index.html/);e&&(e=e[0],t=t.split(e)[0]),(t=t.replace(/(\[|\]|~|#|@)/g,"\\$1"))&&volantis.dom.headerMenu&&volantis.dom.headerMenu.forEach(e=>{e=e.querySelector("[active-action=action-"+t+"]");e&&volantis.dom.$(e).addClass("active")})},s.setGlobalHeaderMenuEvent=()=>{volantis.isMobile?document.querySelectorAll("#l_header .m-phone li").forEach(function(e){e.querySelector(".list-v")&&volantis.dom.$(e).click(function(e){e.stopPropagation(),e.currentTarget.parentElement.childNodes.forEach(function(e){"[object HTMLLIElement]"==Object.prototype.toString.call(e)&&e.childNodes.forEach(function(e){"[object HTMLUListElement]"==Object.prototype.toString.call(e)&&volantis.dom.$(e).hide()})});var t=e.currentTarget.children;for(let e=0;e<t.length;e++){var o=t[e];volantis.dom.$(o).show()}},0)}):document.querySelectorAll("#wrapper .m-pc li > a[href]").forEach(function(e){volantis.dom.$(e.parentElement).click(function(e){e.stopPropagation(),e.target.origin==e.target.baseURI&&document.querySelectorAll("#wrapper .m-pc .list-v").forEach(function(e){volantis.dom.$(e).hide()})},0)}),s.setPageHeaderMenuEvent()},s.setPageHeaderMenuEvent=()=>{volantis.isMobile&&volantis.dom.$(document).click(function(e){volantis.dom.mPhoneList.forEach(function(e){volantis.dom.$(e).hide()})})},s.setHeaderSearch=()=>{volantis.isMobile&&volantis.dom.switcher&&(volantis.dom.switcher.click(function(e){e.stopPropagation(),volantis.dom.header.toggleClass("z_search-open"),volantis.dom.switcher.toggleClass("active")},!1),volantis.dom.$(document).click(function(e){volantis.dom.header.removeClass("z_search-open"),volantis.dom.switcher.removeClass("active")},!1),volantis.dom.search.click(function(e){e.stopPropagation()},!1))},s.setTabs=()=>{let e=document.querySelectorAll("#l_main .tabs .nav-tabs");e&&e.forEach(function(e){e.querySelectorAll("a").forEach(function(e){volantis.dom.$(e).on("click",e=>{e.preventDefault(),e.stopPropagation();const t=volantis.dom.$(e.target.parentElement.parentElement.parentElement);return t.find(".nav-tabs .active").removeClass("active"),volantis.dom.$(e.target.parentElement).addClass("active"),t.find(".tab-content .active").removeClass("active"),t.find(e.target.className).addClass("active"),!1})})})},s.footnotes=()=>{let o=document.querySelectorAll("#l_main .footnote-backref, #l_main .footnote-ref > a");o.forEach(function(e,t){o[t].click=()=>{},volantis.dom.$(e).on("click",e=>{e.stopPropagation(),e.preventDefault();e=decodeURI(e.target.hash.split("#")[1]).replace(/\ /g,"-"),e=document.getElementById(e);e&&volantis.scroll.to(e,{addTop:-volantis.dom.header.offsetHeight-5,behavior:"instant"})})})},s.copyCode=e=>{document.querySelectorAll(e).forEach(n=>{n.insertAdjacentHTML("beforebegin",'<button class="btn-copy" data-clipboard-snippet=""><i class="fas fa-copy"></i><span>COPY</span></button>');const l=n.previousSibling;l.onclick=e=>{e.stopPropagation();const t=l.querySelector("i"),o=l.querySelector("span");n.focus();const a=new Range;a.selectNodeContents(n),document.getSelection().removeAllRanges(),document.getSelection().addRange(a);e=document.getSelection().toString();s.writeClipText(e).then(()=>{volantis.messageCopyright&&volantis.messageCopyright.enable&&volantis.message(volantis.messageCopyright.title,volantis.messageCopyright.message,{icon:volantis.messageCopyright.icon}),l.classList.add("copied"),t.classList.remove("fa-copy"),t.classList.add("fa-check-circle"),o.innerText="COPIED",setTimeout(()=>{t.classList.remove("fa-check-circle"),t.classList.add("fa-copy"),o.innerText="COPY"},2e3)}).catch(e=>{volantis.message("系统提示",e,{icon:"fa fa-exclamation-circle red"}),l.classList.add("copied-failed"),t.classList.remove("fa-copy"),t.classList.add("fa-exclamation-circle"),o.innerText="COPY FAILED",setTimeout(()=>{t.classList.remove("fa-exclamation-circle"),t.classList.add("fa-copy"),o.innerText="COPY"})})}})},s.writeClipText=t=>{try{return navigator.clipboard.writeText(t).then(()=>Promise.resolve()).catch(e=>Promise.reject(e||"复制文本失败!"))}catch(e){const a=document.createElement("input");a.setAttribute("readonly","readonly"),document.body.appendChild(a),a.setAttribute("value",t),a.select();try{var o=document.execCommand("copy");return document.body.removeChild(a),o&&"unsuccessful"!==o?Promise.resolve():Promise.reject("复制文本失败!")}catch(e){return document.body.removeChild(a),Promise.reject("当前浏览器不支持复制功能，请检查更新或更换其他浏览器操作!")}}},{init:()=>{s.init(),s.event()},subscribe:()=>{s.setIsMobile(),s.setHeader(),s.setHeaderMenuSelection(),s.setGlobalHeaderMenuEvent(),s.setHeaderSearch(),s.setScrollAnchor(),s.setTabs(),s.footnotes(),s.copyCode()},pjaxReload:()=>{s.event(),s.restData(),s.setHeader(),s.setHeaderMenuSelection(),s.setPageHeaderMenuEvent(),s.setScrollAnchor(),s.setTabs(),s.footnotes(),s.copyCode(),document.querySelector("#l_header .nav-main").querySelectorAll(".list-v:not(.menu-phone)").forEach(function(e){e.removeAttribute("style")}),document.querySelector("#l_header .menu-phone.list-v").removeAttribute("style")},writeClipText:s.writeClipText,copyCode:s.copyCode}})();Object.freeze(VolantisApp);const volantisFancyBox=(()=>{const t={initFB:()=>{const t=new Set;if(t.add("default"),t.add("Twikoo"),document.querySelector(".md .gallery img, .fancybox")){document.querySelectorAll(".md .gallery").forEach(function(e){e.querySelector("img")&&t.add(e.getAttribute("data-group")||"default")}),Fancybox.destroy();for(const e of t)e&&Fancybox.bind('[data-fancybox="'+e+'"]',{Hash:!1})}},loadFancyBox:e=>{document.querySelector(".md .gallery img, .fancybox")&&(volantis.css(" https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css"),volantis.js("https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js").then(()=>{t.initFB(),e&&e()}))}};return{loadFancyBox:(e=null)=>{t.loadFancyBox(e)},initFancyBox:()=>{t.initFB()},pjaxReload:()=>{"undefined"==typeof Fancybox?t.loadFancyBox():t.initFB()}}})();Object.freeze(volantisFancyBox);const highlightKeyWords=(()=>{let c={markNum:0,markNextId:-1,startFromURL:()=>{const e=decodeURI(new URL(location.href).searchParams.get("keyword"));var t=e?e.split(" "):[],o=document.querySelector("#l_main");1==t.length&&"null"==t[0]||(c.start(t,o),c.scrollToFirstHighlightKeywordMark())},scrollToFirstHighlightKeywordMark:()=>{c.scrollToNextHighlightKeywordMark("0")||volantis.requestAnimationFrame(c.scrollToFirstHighlightKeywordMark)},scrollToNextHighlightKeywordMark:e=>{e=e||(c.markNextId+1)%c.markNum;c.markNextId=parseInt(e);let t=document.getElementById("keyword-mark-"+c.markNextId);return t||(c.markNextId=(c.markNextId+1)%c.markNum,t=document.getElementById("keyword-mark-"+c.markNextId)),t&&volantis.scroll.to(t,{addTop:-volantis.dom.header.offsetHeight-5,behavior:"instant"}),t},scrollToPrevHighlightKeywordMark:e=>{e=e||(c.markNextId-1+c.markNum)%c.markNum;c.markNextId=parseInt(e);let t=document.getElementById("keyword-mark-"+c.markNextId);return t||(c.markNextId=(c.markNextId-1+c.markNum)%c.markNum,t=document.getElementById("keyword-mark-"+c.markNextId)),t&&volantis.scroll.to(t,{addTop:-volantis.dom.header.offsetHeight-5,behavior:"instant"}),t},start:(o,e)=>{if(c.markNum=0,o.length&&e&&(1!=o.length||"null"!=o[0])){console.log(o);const t=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null),a=[];for(;t.nextNode();)t.currentNode.parentNode.matches("button, select, textarea")||a.push(t.currentNode);a.forEach(e=>{var[t]=c.getIndexByWord(o,e.nodeValue);t.length&&(t=c.mergeIntoSlice(0,e.nodeValue.length,t),c.highlightText(e,t,"keyword"),c.highlightStyle())})}},getIndexByWord:(e,n,l=!1)=>{const s=[],i=new Set;return e.forEach(t=>{const e=document.createElement("div");e.innerText=t;var o=(t=e.innerHTML).length;if(0!==o){let e=0;var a;for(l||(n=n.toLowerCase(),t=t.toLowerCase());-1<(a=n.indexOf(t,e));)s.push({position:a,word:t}),i.add(t),e=a+o}}),s.sort((e,t)=>e.position!==t.position?e.position-t.position:t.word.length-e.word.length),[s,i]},mergeIntoSlice:(e,t,o)=>{var a;let{position:n,word:l}=a=o[0];const s=[],i=new Set;for(;n+l.length<=t&&0!==o.length;){i.add(l),s.push({position:n,length:l.length});var r=n+l.length;for(o.shift();0!==o.length&&(a=o[0],n=a.position,l=a.word,r>n);)o.shift()}return{hits:s,start:e,end:t,count:i.size}},highlightText:(t,e,o)=>{const a=t.nodeValue;let n=e.start;const l=[];for(var{position:s,length:i}of e.hits){var r=document.createTextNode(a.substring(n,s));n=s+i;let e=document.createElement("mark");e.className=o,e=c.highlightStyle(e),e.appendChild(document.createTextNode(a.substr(s,i))),l.push(r,e)}t.nodeValue=a.substring(n,e.end),l.forEach(e=>{t.parentNode.insertBefore(e,t)})},highlightStyle:e=>{if(e)return e.id="keyword-mark-"+c.markNum,c.markNum++,e.style.background="transparent",e.style["border-bottom"]="1px dashed #ff2a2a",e.style.color="#ff2a2a",e.style["font-weight"]="bold",e},cleanHighlightStyle:()=>{document.querySelectorAll(".keyword").forEach(e=>{e.style.background="transparent",e.style["border-bottom"]=null,e.style.color=null,e.style["font-weight"]=null})}};return{start:(e,t)=>{c.start(e,t)},startFromURL:()=>{c.startFromURL()},scrollToNextHighlightKeywordMark:e=>{c.scrollToNextHighlightKeywordMark(e)},scrollToPrevHighlightKeywordMark:e=>{c.scrollToPrevHighlightKeywordMark(e)},cleanHighlightStyle:()=>{c.cleanHighlightStyle()}}})();Object.freeze(highlightKeyWords);